!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3js"],e):"object"==typeof exports?exports.d3LdvmPipeline=e(require("d3")):t.d3LdvmPipeline=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(){var t=1800,e=700,n=70,r=["suit","licensing","resolved"],o=function(o){return o.each(function(o){function i(){return g.append("svg").attr("class","ldvm").attr("width",t).attr("height",e)}function a(){var r=v["default"](h,m);y["default"]().width(t).height(e).nodeSize(n).run(r)}function l(){h.forEach(function(t){return t.size(n)}),x.append("defs").selectAll("marker").data(_).enter().append(function(t){return t.render()}),x.append("g").selectAll("path").data(m).enter().append(function(t){return t.render()}),x.append("g").selectAll(".ldvm-component").data(h).enter().append(function(t){return t.render()})}function f(){h.forEach(function(t){return t.update()}),m.forEach(function(t){return t.update()})}var d=s["default"](o),h=d.components,m=d.bindings,g=u["default"].select(this),x=i(),_=r.map(function(t){return new c["default"](n/10,t)});g.append(function(){return p["default"].render()}),a(),l(),f()})},i=function(){return o};return o.width=function(e){return void 0===e?t:i(t=e)},o.height=function(t){return void 0===t?e:i(e=t)},o.nodeSize=function(t){return void 0===t?n:i(n=t)},o.componentTypes=function(t){return void 0===t?r:i(r=t)},o}var o=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=n(1),u=o(i),a=n(7),l=(o(a),n(2)),s=o(l),f=n(3),c=o(f),d=n(4),p=o(d),h=n(5),v=o(h),m=n(6),y=o(m);t.exports=e["default"]},function(e,n,r){e.exports=t},function(t,e,n){"use strict";function r(t){var e={},n=t.components.map(function(t){var n=new u["default"](t,t.inputs,t.outputs);return t.inputs.forEach(function(t,r){t.rank=r,t.component=n,e[t.uri]=t}),t.outputs.forEach(function(t,r){t.rank=r,t.component=n,e[t.uri]=t}),n}),r=t.bindings.map(function(t){var n=new l["default"](t,e[t.sourceUri],e[t.targetUri]);return n.sourcePort.binding=n.targetPort.binding=n,n});return{components:n,bindings:r}}var o=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=n(9),u=o(i),a=n(10),l=o(a);t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),a=(r(u),n(11)),l=function(){function t(e,n){o(this,t),this.size=e,this.type=n}return i(t,[{key:"render",value:function(){var t=a.createElement("marker").attr("id",this.type).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-1.5).attr("markerWidth",this.size).attr("markerHeight",this.size).attr("orient","auto");return t.append("path").attr("d","M0,-5L10,0L0,5"),t.node()}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=r(o),u="Default label",a="",l="Default content",s=0,f=0,c=null,d=function(){};d.render=function(){return c=i["default"].select(document.createElement("div")).attr("class","ldvm-tooltip"),c.append("div").attr("class","ldvm-tooltip-label"),c.append("div").attr("class","ldvm-tooltip-uri"),c.append("div").attr("class","ldvm-tooltip-content"),c.node()},d.show=function(){c&&(c.select(".ldvm-tooltip-label").html(u),c.select(".ldvm-tooltip-uri").html(a),c.select(".ldvm-tooltip-content").html(l),c.transition().duration(200).style("top",f+"px").style("left",s+"px").style("opacity",1))},d.hide=function(){c&&c.transition().duration(200).style("opacity",0)};var p=function(){return d};d.label=function(t){return void 0===t?u:p(u=t)},d.uri=function(t){return void 0===t?a:p(a=t)},d.content=function(t){return void 0===t?l:p(l=t)},d.x=function(t){return void 0===t?s:p(s=t)},d.y=function(t){return void 0===t?f:p(f=t)},e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";function r(t,e){t.forEach(function(t){t.children=[],t.parent=null}),e.forEach(function(t){t.source.parent||(t.source.parent=t.target,t.target.children.push(t.source))});var n=t.filter(function(t){return t.type()==o.VISUALIZER}),r={children:n,parent:null};return n.forEach(function(t){return t.parent=r}),r}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var o=n(12);t.exports=e["default"]},function(t,e,n){"use strict";function r(){var t=1800,e=700,n=70,r=function(){};r.run=function(r){if(r&&r.children&&0!=r.children.length){u["default"].layout.tree().nodeSize([n,n]).separation(function(t,e){return n*(t.parent==e.parent?2:3)}).size([e-n,t-n]).nodes(r);for(var o=r.children[0].y-r.y,i=[r],a=!0;i.length>0;){var l=i.shift(),s=l.x,f=l.y;l.x=t-f+o/2-n/2,l.y=s+n/2,l.x=l.x+(a?1:-1)*(n/2)*1.2,a=!a,i=i.concat(l.children||[])}}};var o=function(){return r};return r.width=function(e){return void 0===e?t:o(t=e)},r.height=function(t){return void 0===t?e:o(e=t)},r.nodeSize=function(t){return void 0===t?componentSize:o(n=t)},r}var o=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=r;var i=n(1),u=o(i);t.exports=e["default"]},function(t,e,n){var r=n(8);"string"==typeof r&&(r=[[t.id,r,""]]);n(13)(r,{})},function(t,e,n){e=t.exports=n(14)(),e.push([t.id,".ldvm-component-body{fill-opacity:.7;stroke:#fff;stroke-width:1.5px}.ldvm-component-label{font:11px sans-serif;pointer-events:none;text-shadow:0 1px 0 #fff,1px 0 0 #fff,0 -1px 0 #fff,-1px 0 0 #fff}.ldvm-component-datasource{fill:#013C5A}.ldvm-component-analyzer,.ldvm-component-transformer{fill:#028E85}.ldvm-component-visualizer{fill:#02D6A1}.ldvm-component-port{fill:#4b676f;stroke:#fff;stroke-width:1.5px}.ldvm-link{fill:none;stroke:#666;stroke-width:1.5px}.ldvm-link.ldvm-licensing{stroke:green}.ldvm-link.ldvm-resolved{stroke-dasharray:0,2 1}.ldvm-loading-bar text{font:12px sans-serif;text-shadow:0 1px 1px #fff,1px 0 1px #fff,0 -1px 1px #fff,-1px 0 1px #fff}.ldvm-loading-bar .ldvm-outer{fill-opacity:0;stroke:#4b676f;stroke-width:1px}.ldvm-loading-bar .ldvm-inner{fill:#4b676f;fill-opacity:1}.ldvm-tooltip{max-width:300px;position:absolute;font:12px sans-serif;border:1px solid #6e97a3;border-radius:4px;pointer-events:none;background-color:rgba(255,255,255,.8);box-shadow:#fff 0 0 1px,#fff 0 0 1px;opacity:0}.ldvm-tooltip div{padding:5px}.ldvm-tooltip-label{font-weight:700;background-color:rgba(2,142,133,.8);color:#fff}.ldvm-tooltip-uri{color:#013C5A}",""])},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),a=r(u),l=n(4),s=r(l),f=n(11),c=8,d=function(){function t(e,n,r){o(this,t),this.data=e,this.inputs=n,this.outputs=r,this._size=70,this._element=null}return i(t,[{key:"render",value:function(){var t=this;return this._element||!function(){var e=f.createElement("g").attr("class","ldvm-component");e.style("opacity",0).transition().style("opacity",1),e.append(function(){return t._renderLabel()}),e.append(function(){return t._renderBody()}),t.inputs.forEach(function(n){return e.append(function(){return t._renderInput(n)})}),t.outputs.forEach(function(n){return e.append(function(){return t._renderOutput(n)})}),e.on("mouseover",function(){return t._hightlightGroup(!0)}),e.on("mouseout",function(){return t._hightlightGroup(!1)}),t._element=e}(),this._element.node()}},{key:"update",value:function(){this._element&&this._element.attr("transform","translate("+this.x+","+this.y+")")}},{key:"size",value:function(t){return void 0===t?this._size:(this._size=t,this)}},{key:"type",value:function(){return this.data.type}},{key:"highlight",value:function(t){this._element&&this._element.select(".ldvm-component-body").transition().style("fill-opacity",t?1:.7)}},{key:"_renderLabel",value:function(){return f.createElement("text").text(this.data.label).attr("class","ldvm-component-label").attr("x",0).attr("y",this._size/2+10).attr("text-anchor","middle").node()}},{key:"_renderBody",value:function(){var t=this;return f.createElement("rect").attr("class","ldvm-component-body ldvm-component-"+this.data.type).attr("width",this._size).attr("height",this._size).attr("x",-this._size/2).attr("y",-this._size/2).attr("rx",c).attr("ry",c).on("mouseover",function(){return s["default"].label(t.data.label).uri(t.data.uri).content(t.data.htmlContent).x(f.realPosition(t._element).x).y(f.realPosition(t._element).y+t._size).show()}).on("mouseout",function(){return s["default"].hide()}).node()}},{key:"_hightlightGroup",value:function(t){this.highlight(t),this.inputs.forEach(function(e){return e.binding.source.highlight(t)}),this.outputs.forEach(function(e){return e.binding.target.highlight(t)})}},{key:"_renderInput",value:function(t){return this._renderPort(this._getInputCoords(t),t)}},{key:"_renderOutput",value:function(t){return this._renderPort(this._getOutputCoords(t),t)}},{key:"_renderPort",value:function(t,e){return f.createElement("circle").attr("class","ldvm-component-port").attr("cx",t.x).attr("cy",t.y).attr("r",this._getPortSize()/2).on("mouseover",function(){return s["default"].label(e.label).uri(e.uri).content("").x(a["default"].event.pageX).y(a["default"].event.pageY).show()}).on("mouseout",function(){return s["default"].hide()}).node()}},{key:"_getInputCoords",value:function(t){return{x:-this._size/2,y:this._getPortY(this.inputs.indexOf(t),this.inputs.length)}}},{key:"_getOutputCoords",value:function(t){return{x:this._size/2,y:this._getPortY(this.outputs.indexOf(t),this.outputs.length)}}},{key:"_getPortY",value:function(t,e){var n=this._size/e;return-this._size/2+t*n+n/2}},{key:"_getPortSize",value:function(){return this._size/6}},{key:"getPortCoords",value:function(t){var e=void 0;if(e=this._findPortByUri(this.inputs,t))return this._getInputCoords(e);if(e=this._findPortByUri(this.outputs,t))return this._getOutputCoords(e);throw new Error("Port does not exist: "+t)}},{key:"_findPortByUri",value:function(t,e){var n=t.filter(function(t){return t.uri==e});return n.length>0?n[0]:!1}}]),t}();e["default"]=d,t.exports=e["default"]},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();Object.defineProperty(e,"__esModule",{value:!0});var u=n(1),a=(r(u),n(11)),l=function(){function t(e,n,r){o(this,t),this.data=e,this.sourcePort=n,this.targetPort=r,this.source=n.component,this.target=r.component,this.rank=r.rank,this._element=null}return i(t,[{key:"render",value:function(){return this._element||(this._element=a.createElement("line").attr("class","ldvm-link ldvm-"+this.data.type).attr("marker-end","url(#"+this.data.type+")")),this._element.node()}},{key:"update",value:function(){if(this._element){var t=this.source.getPortCoords(this.sourcePort.uri),e=this.target.getPortCoords(this.targetPort.uri),n={x:this.source.x+t.x,y:this.source.y+t.y},r={x:this.target.x+e.x,y:this.target.y+e.y};this._element.attr("x1",n.x).attr("y1",n.y).attr("x2",r.x).attr("y2",r.y)}}}]),t}();e["default"]=l,t.exports=e["default"]},function(t,e,n){"use strict";function r(t){return a["default"].select(document.createElementNS("http://www.w3.org/2000/svg",t))}function o(t){return t?{x:t.node().getBoundingClientRect().left+document.body.scrollLeft,y:t.node().getBoundingClientRect().top+document.body.scrollTop}:{x:0,y:0}}var i=function(t){return t&&t.__esModule?t:{"default":t}};Object.defineProperty(e,"__esModule",{value:!0}),e.createElement=r,e.realPosition=o;var u=n(1),a=i(u)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="visualizer";e.VISUALIZER=r;var o="transformer";e.TRANSFORMER=o;var i="datasource";e.DATASOURCE=i;var u="analyzer";e.ANALYZER=u},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=c[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(a(r.parts[i],e))}else{for(var u=[],i=0;i<r.parts.length;i++)u.push(a(r.parts[i],e));c[r.id]={id:r.id,refs:1,parts:u}}}}function o(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],u=o[1],a=o[2],l=o[3],s={css:u,media:a,sourceMap:l};n[i]?n[i].parts.push(s):e.push(n[i]={id:i,parts:[s]})}return e}function i(){var t=document.createElement("style"),e=h();return t.type="text/css",e.appendChild(t),t}function u(){var t=document.createElement("link"),e=h();return t.rel="stylesheet",e.appendChild(t),t}function a(t,e){var n,r,o;if(e.singleton){var a=m++;n=v||(v=i()),r=l.bind(null,n,a,!1),o=l.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=u(),r=f.bind(null,n),o=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=i(),r=s.bind(null,n),o=function(){n.parentNode.removeChild(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function l(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var i=document.createTextNode(o),u=t.childNodes;u[e]&&t.removeChild(u[e]),u.length?t.insertBefore(i,u[e]):t.appendChild(i)}}function s(t,e){{var n=e.css,r=e.media;e.sourceMap}if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,r=(e.media,e.sourceMap);r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(JSON.stringify(r))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var c={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),h=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,m=0;t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p());var n=o(t);return r(n,e),function(t){for(var i=[],u=0;u<n.length;u++){var a=n[u],l=c[a.id];l.refs--,i.push(l)}if(t){var s=o(t);r(s,e)}for(var u=0;u<i.length;u++){var l=i[u];if(0===l.refs){for(var f=0;f<l.parts.length;f++)l.parts[f]();delete c[l.id]}}}};var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];t.push(n[2]?"@media "+n[2]+"{"+n[1]+"}":n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(var o=0;o<e.length;o++){var u=e[o];"number"==typeof u[0]&&r[u[0]]||(n&&!u[2]?u[2]=n:n&&(u[2]="("+u[2]+") and ("+n+")"),t.push(u))}},t}}])});